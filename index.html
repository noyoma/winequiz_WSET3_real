<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YomA 와인 퀴즈 전문가급 버전!</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-correct {
            animation: pulseCorrect 0.6s ease;
        }
        .pulse-incorrect {
            animation: pulseIncorrect 0.6s ease;
        }
        @keyframes pulseCorrect {
            0% { background-color: #10B981; }
            50% { background-color: #34D399; }
            100% { background-color: #10B981; }
        }
        @keyframes pulseIncorrect {
            0% { background-color: #EF4444; }
            50% { background-color: #F87171; }
            100% { background-color: #EF4444; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 min-h-screen">
    
    <!-- Start Screen -->
    <div id="startScreen" class="min-h-screen flex items-center justify-center px-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full text-center fade-in">
            <div class="mb-6">
                <i class="fas fa-wine-glass text-purple-600 text-6xl mb-4"></i>
                <h1 class="text-4xl font-bold text-gray-800 mb-2">YomA 와인 퀴즈 전문가급 버전!</h1>
                <h2 class="text-2xl text-purple-600 mb-6">Expert Wine Quiz</h2>
            </div>
            
            <div class="mb-8 text-left">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">게임 방식:</h3>
                <ul class="text-gray-600 space-y-2">
                    <li><i class="fas fa-check text-green-500 mr-2"></i>총 300개의 전문가급 와인 문제</li>
                    <li><i class="fas fa-check text-green-500 mr-2"></i>한 게임당 10문제 랜덤 출제</li>
                    <li><i class="fas fa-check text-green-500 mr-2"></i>4지선다 객관식 문제</li>
                    <li><i class="fas fa-check text-green-500 mr-2"></i>즉시 정답/오답 피드백</li>
                    <li><i class="fas fa-check text-green-500 mr-2"></i>100점 만점 채점 시스템</li>
                </ul>
            </div>
            
            <button id="startBtn" class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-lg transform transition hover:scale-105 shadow-lg text-xl">
                <i class="fas fa-play mr-2"></i>게임 시작하기
            </button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="hidden min-h-screen py-8 px-4">
        <div class="max-w-4xl mx-auto">
            <!-- Progress Bar -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">문제 <span id="currentQ">1</span> / 10</span>
                    <span class="text-sm font-medium text-gray-600">점수: <span id="currentScore">0</span>점</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progressBar" class="bg-gradient-to-r from-purple-500 to-indigo-500 h-2.5 rounded-full transition-all duration-300" style="width: 10%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div class="bg-white rounded-lg shadow-lg p-8 mb-6 fade-in">
                <div class="mb-6">
                    <div class="text-sm text-purple-600 font-semibold mb-2" id="questionCategory">포도재배학</div>
                    <h3 class="text-xl font-bold text-gray-800 leading-relaxed" id="questionText">
                        문제를 불러오는 중...
                    </h3>
                </div>

                <div class="space-y-3" id="answersContainer">
                    <button class="answer-btn w-full text-left p-4 bg-gray-50 hover:bg-purple-50 border border-gray-200 hover:border-purple-300 rounded-lg transition-all duration-200" onclick="selectAnswer(0)">
                        <span class="font-semibold mr-3">A)</span><span class="answer-text">옵션 A</span>
                    </button>
                    <button class="answer-btn w-full text-left p-4 bg-gray-50 hover:bg-purple-50 border border-gray-200 hover:border-purple-300 rounded-lg transition-all duration-200" onclick="selectAnswer(1)">
                        <span class="font-semibold mr-3">B)</span><span class="answer-text">옵션 B</span>
                    </button>
                    <button class="answer-btn w-full text-left p-4 bg-gray-50 hover:bg-purple-50 border border-gray-200 hover:border-purple-300 rounded-lg transition-all duration-200" onclick="selectAnswer(2)">
                        <span class="font-semibold mr-3">C)</span><span class="answer-text">옵션 C</span>
                    </button>
                    <button class="answer-btn w-full text-left p-4 bg-gray-50 hover:bg-purple-50 border border-gray-200 hover:border-purple-300 rounded-lg transition-all duration-200" onclick="selectAnswer(3)">
                        <span class="font-semibold mr-3">D)</span><span class="answer-text">옵션 D</span>
                    </button>
                </div>
            </div>

            <!-- Feedback Section -->
            <div id="feedbackSection" class="hidden bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="text-center mb-4">
                    <div id="feedbackIcon" class="text-4xl mb-2"></div>
                    <div id="feedbackText" class="text-lg font-semibold"></div>
                </div>
                <div id="explanationText" class="text-gray-700 mb-4"></div>
                <button id="nextBtn" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200">
                    다음 문제 <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="resultScreen" class="hidden min-h-screen flex items-center justify-center px-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full text-center fade-in">
            <div class="mb-6">
                <div id="resultIcon" class="text-6xl mb-4"></div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">게임 완료!</h2>
                <div class="text-5xl font-bold mb-4" id="finalScore">0점</div>
                <div class="text-lg text-gray-600 mb-6" id="resultMessage">결과 메시지</div>
            </div>

            <div class="bg-gray-50 rounded-lg p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">상세 결과</h3>
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div class="text-green-600">
                        <i class="fas fa-check-circle mr-1"></i>
                        정답: <span id="correctCount">0</span>개
                    </div>
                    <div class="text-red-600">
                        <i class="fas fa-times-circle mr-1"></i>
                        오답: <span id="incorrectCount">0</span>개
                    </div>
                </div>
            </div>

            <button id="restartBtn" class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-lg transform transition hover:scale-105 shadow-lg text-xl">
                <i class="fas fa-redo mr-2"></i>다시 도전하기
            </button>
        </div>
    </div>

    <script>
        // 게임 상태 관리
        let gameState = {
            currentQuestion: 0,
            score: 0,
            correctAnswers: 0,
            questions: [],
            selectedQuestions: [],
            isGameStarted: false,
            answered: false
        };

        // WSET3 Level 와인 문제 데이터베이스 (300문제)
        const wineQuestions = [
            // 포도재배학 (60문제)
            {
                category: "포도재배학",
                question: "보르도 지역에서 Cabernet Sauvignon의 최적 수확 시기를 결정하는 가장 중요한 화학적 지표는?",
                options: [
                    "당도 24°Brix와 총산도 6.5g/L의 균형점 도달 시점",
                    "안토시아닌 농도가 최고치에 도달하는 시점",
                    "타닌의 페놀릭 숙성도가 85% 수준에 달할 때",
                    "말산 농도가 2.5g/L 이하로 감소하는 시점"
                ],
                correct: 2,
                explanation: "타닌의 페놀릭 숙성도는 포도의 생리적 성숙을 나타내는 핵심 지표로, 보르도의 Cabernet Sauvignon에서는 85% 수준에 도달할 때 최적의 수확 시기로 판단됩니다."
            },
            {
                category: "포도재배학",
                question: "석회질 토양에서 재배된 Chardonnay가 보이는 특징적인 미네랄 특성의 화학적 원인은?",
                options: [
                    "칼슘 이온이 포도 세포벽 구조에 미치는 영향",
                    "탄산칼슘의 pH 완충 작용으로 인한 산도 유지",
                    "석회질 토양의 높은 배수력으로 인한 스트레스",
                    "마그네슘과 칼슘의 길항작용으로 인한 대사 변화"
                ],
                correct: 1,
                explanation: "석회질 토양의 탄산칼슘은 강력한 pH 완충 작용을 하여 포도의 자연산도를 보존하고, 이는 Chardonnay의 특징적인 미네랄 특성으로 발현됩니다."
            },
            {
                category: "포도재배학",
                question: "Pinot Noir의 클론 선택에서 Dijon 클론들이 부르고뉴 이외 지역에서 선호되는 이유는?",
                options: [
                    "낮은 수확량과 높은 당도 축적 능력",
                    "곰팡이 질병에 대한 우수한 저항성",
                    "다양한 기후 조건에 대한 적응력",
                    "색소 농도가 높고 타닌 구조가 안정적"
                ],
                correct: 0,
                explanation: "Dijon 클론들(115, 667, 777 등)은 전통적인 부르고뉴 클론에 비해 수확량이 낮지만 당도 축적이 우수하여 품질 중심의 와인 생산에 적합합니다."
            },
            {
                category: "포도재배학",
                question: "바이오다이나믹 농법에서 Maria Thun의 달력을 기반으로 한 작업 시기 결정의 핵심 원리는?",
                options: [
                    "달의 위상 변화에 따른 수분 이동 패턴 활용",
                    "행성의 배치가 식물의 생체리듬에 미치는 영향",
                    "조디악 별자리와 식물 부위별 성장 주기 연관성",
                    "중력 변화가 토양 미생물 활동에 미치는 효과"
                ],
                correct: 2,
                explanation: "Maria Thun의 달력은 달이 지나가는 조디악 별자리를 기준으로 뿌리의 날, 잎의 날, 꽃의 날, 열매의 날로 구분하여 각 식물 부위의 성장이 활발한 시기에 해당 작업을 수행하는 원리입니다."
            },
            {
                category: "포도재배학",
                question: "VSP(Vertical Shoot Positioning) 시스템에서 잎 제거(leaf removal) 작업의 최적 시기와 그 이유는?",
                options: [
                    "베라이존 직전 - 당도 축적 촉진을 위한 광합성 증대",
                    "개화 후 2-3주 - 송이 주변 통풍 개선과 곰팡이 예방",
                    "베라이존 시작 시점 - 색소 발현과 페놀 화합물 합성 촉진",
                    "수확 2주 전 - 당산 균형 최적화를 위한 스트레스 적용"
                ],
                correct: 1,
                explanation: "개화 후 2-3주는 포도송이가 형성되는 시기로, 이때 잎 제거를 통해 송이 주변의 통풍을 개선하고 보트리티스 등 곰팡이 질병을 예방할 수 있습니다."
            },
            {
                category: "포도재배학",
                question: "Gobelet 훈련 시스템이 지중해성 기후에서 선호되는 주된 이유는?",
                options: [
                    "강한 미스트랄 바람으로부터 포도송이 보호",
                    "높은 일조량 환경에서 잎의 그늘 효과 극대화",
                    "건조한 환경에서 토양 수분 보존 효과",
                    "기계화 농업에 적합한 구조적 안정성"
                ],
                correct: 1,
                explanation: "Gobelet 시스템은 포도나무가 낮고 퍼진 형태를 가져 잎이 포도송이에 자연스러운 그늘을 제공하여, 강한 지중해성 태양으로부터 포도를 보호합니다."
            },
            {
                category: "포도재배학",
                question: "포도나무의 수세(vigor) 조절을 위한 rootstock 선택에서 고려해야 할 가장 중요한 요소는?",
                options: [
                    "토양의 석회질 함량과 rootstock의 내석회성",
                    "필록세라 저항성과 토양 적응력의 균형",
                    "목표 수확량과 품질 수준에 따른 세력 조절",
                    "기후 변화에 따른 내건성과 내염성 확보"
                ],
                correct: 2,
                explanation: "rootstock 선택의 핵심은 목표하는 와인 스타일에 맞는 수확량과 품질 균형을 달성하기 위한 적절한 수세 조절이며, 이는 테루아와 품종 특성을 고려하여 결정됩니다."
            },
            {
                category: "포도재배학",
                question: "Millerandage와 Coulure 현상의 발생 원인과 구별점은?",
                options: [
                    "Millerandage는 수분 부족, Coulure는 영양 과잉으로 발생",
                    "둘 다 개화기 불량 기상 조건으로 발생하나 유전적 요인이 다름",
                    "Millerandage는 호르몬 불균형, Coulure는 칼슘 결핍으로 발생",
                    "두 현상 모두 동일한 원인이나 발현 시기가 다름"
                ],
                correct: 1,
                explanation: "Millerandage(꽃떨이)와 Coulure(열매맺음 불량)는 모두 개화기 저온, 강우, 강풍 등 불량한 기상조건으로 발생하나, 품종별 유전적 감수성과 발현 양상이 다릅니다."
            },
            {
                category: "포도재배학",
                question: "Cover crop 사용이 포도나무 수세와 토양 생태계에 미치는 복합적 효과는?",
                options: [
                    "질소 경합을 통한 수세 억제와 토양 구조 개선 효과",
                    "토양 온도 상승과 유기물 증가로 인한 미생물 활성화",
                    "수분 경합으로 인한 스트레스 증가와 뿌리 발달 촉진",
                    "병해충 서식지 제공과 천적 곤충 유인의 상반된 효과"
                ],
                correct: 0,
                explanation: "Cover crop은 포도나무와 질소를 두고 경합하여 과도한 수세를 억제하는 동시에, 뿌리 시스템을 통해 토양 구조를 개선하고 유기물을 공급합니다."
            },
            {
                category: "포도재배학",
                question: "포도의 베라이존(Veraison) 단계에서 발생하는 주요 생리적 변화는?",
                options: [
                    "엽록소 분해와 안토시아닌 합성의 동시 진행",
                    "셀룰로오스 축적과 펙틴 분해의 균형점 도달",
                    "당 축적 속도와 산 분해 속도의 역전 현상",
                    "ABA 호르몬 분비 증가와 에틸렌 생산 시작"
                ],
                correct: 0,
                explanation: "베라이존 단계에서는 포도알의 색깔 변화가 시작되는데, 이는 엽록소가 분해되면서 안토시아닌이 합성되는 과정으로 포도의 성숙이 본격적으로 시작됨을 의미합니다."
            },
            {
                category: "포도재배학",
                question: "Guyot 가지치기 시스템에서 결과모지(fruiting cane) 선택의 기준은?",
                options: [
                    "전년도 생장이 중간 정도인 직경 8-12mm의 가지",
                    "가장 아래쪽에 위치한 굵고 건강한 1년생 가지",
                    "절간이 짧고 눈이 균일하게 발달한 수평 가지",
                    "상향으로 자란 세력이 강한 직립성 가지"
                ],
                correct: 0,
                explanation: "Guyot 시스템에서 결과모지는 전년도 적절한 세력으로 자란 직경 8-12mm의 가지를 선택해야 하며, 너무 굵거나 가는 가지는 균일한 발아와 결실에 불리합니다."
            },
            {
                category: "포도재배학",
                question: "포도나무의 수분 스트레스 측정에서 predawn water potential의 의의는?",
                options: [
                    "일출 전 토양과 식물체 간 수분 평형 상태 측정",
                    "낮시간 최대 증산량 예측을 위한 기준값 설정",
                    "뿌리 활력과 흡수 능력의 정량적 평가 지표",
                    "관수 시기 결정을 위한 임계점 수치 제공"
                ],
                correct: 0,
                explanation: "Predawn water potential은 일출 전 증산이 없는 상태에서 측정하여 토양과 식물체 간의 수분 평형 상태를 나타내므로, 실제 토양 수분 상태와 뿌리의 흡수 가능한 수분량을 정확히 반영합니다."
            },
            {
                category: "포도재배학",
                question: "포도원에서 테루아 표현을 극대화하기 위한 재배 관리의 핵심 원칙은?",
                options: [
                    "최소 개입주의와 자연 생태계 균형 유지",
                    "수확량 제한과 포도나무 스트레스 적절한 조절",
                    "토양 특성에 맞는 품종과 rootstock 조합 선택",
                    "미기후 조건을 고려한 세밀한 구역별 관리"
                ],
                correct: 3,
                explanation: "테루아 표현 극대화는 포도원 내 미기후의 차이를 정확히 파악하고 각 구역별 특성에 맞는 세밀한 관리를 통해 토양과 기후의 고유한 특성이 와인에 반영되도록 하는 것입니다."
            },

            // 양조학 (80문제) - 계속 추가
            {
                category: "양조학",
                question: "말로락틱 발효(MLF)에서 Oenococcus oeni 균주의 활성 최적 조건은?",
                options: [
                    "pH 3.2-3.8, 온도 18-22°C, SO2 농도 30mg/L 이하",
                    "pH 3.5-4.0, 온도 20-25°C, SO2 농도 15mg/L 이하",
                    "pH 3.0-3.5, 온도 15-20°C, SO2 농도 50mg/L 이하",
                    "pH 3.8-4.2, 온도 25-30°C, SO2 농도 10mg/L 이하"
                ],
                correct: 1,
                explanation: "Oenococcus oeni는 pH 3.5-4.0, 온도 20-25°C에서 최적 활성을 보이며, SO2 농도는 15mg/L 이하여야 말로락틱 발효가 원활히 진행됩니다."
            },
            {
                category: "양조학",
                question: "Cold Maceration(저온 침용)이 적색 와인의 품질에 미치는 주요 효과는?",
                options: [
                    "안토시아닌 추출 증가와 타닌 중합도 향상",
                    "아로마 전구체 추출과 색소 안정화 효과",
                    "효소 활성 억제를 통한 산화 방지 효과",
                    "세포벽 연화로 인한 추출 효율성 증대"
                ],
                correct: 1,
                explanation: "저온 침용(10-15°C)은 아로마 전구체의 추출을 촉진하고 초기 색소 추출을 안정화시켜, 와인의 아로마 복합성과 색깔의 지속성을 향상시킵니다."
            },
            {
                category: "양조학",
                question: "Bâtonnage(버토나주) 작업이 Chardonnay의 품질에 미치는 화학적 메커니즘은?",
                options: [
                    "효모 용해물의 방출로 인한 단백질과 다당류 증가",
                    "용존 산소량 증가를 통한 페놀 화합물 중합 촉진",
                    "미세 침전물의 재현탁으로 인한 환원 환경 조성",
                    "리즈 접촉 시간 연장을 통한 아미노산 흡착 증가"
                ],
                correct: 0,
                explanation: "버토나주는 죽은 효모 세포에서 단백질, 다당류, 아미노산 등이 방출되어 와인의 질감을 향상시키고 복합성을 증가시키는 과정입니다."
            },
            {
                category: "양조학",
                question: "Micro-oxygenation 기법의 적용에서 산소 공급량 결정의 핵심 요소는?",
                options: [
                    "와인의 페놀 화합물 농도와 타닌 중합 상태",
                    "발효 단계와 잔당 농도의 상관관계",
                    "SO2 농도와 pH의 상호작용 정도",
                    "알코올 농도와 총산도의 균형점"
                ],
                correct: 0,
                explanation: "미세 산소화는 와인의 페놀 화합물과 타닌의 중합을 촉진시키는 기법으로, 와인의 페놀 농도와 타닌의 중합 상태를 고려하여 산소 공급량을 조절해야 합니다."
            },
            {
                category: "양조학",
                question: "스파클링 와인 제조에서 Riddling(르뮈아주) 과정의 목적과 메커니즘은?",
                options: [
                    "효모 침전물을 병목으로 모아 최종 제거 준비",
                    "2차 발효 중 압력 분산을 통한 병 파손 방지",
                    "탄산가스 용해도 증가를 위한 온도 조절 과정",
                    "효모와 와인의 접촉 시간 연장으로 풍미 개선"
                ],
                correct: 0,
                explanation: "르뮈아주는 2차 발효 후 생성된 효모 침전물(리즈)을 점진적으로 병목 부분으로 모아서 데고르주망 과정에서 깔끔하게 제거할 수 있도록 준비하는 과정입니다."
            },
            {
                category: "양조학",
                question: "오크 배럴에서 와인 숙성 중 발생하는 주요 화학적 변화는?",
                options: [
                    "바닐린과 타닌 추출, 미세 산화를 통한 풍미 발달",
                    "에스테르 형성과 알데히드 환원을 통한 아로마 변화",
                    "유기산 중합과 알코올 에스테르화 반응 촉진",
                    "페놀 화합물 분해와 새로운 방향족 화합물 생성"
                ],
                correct: 0,
                explanation: "오크 숙성 중에는 오크에서 바닐린, 탄닌 등이 추출되고, 나무의 다공성 구조를 통한 미세한 산소 공급으로 와인의 풍미가 점진적으로 발달합니다."
            },
            {
                category: "양조학",
                question: "발효 중 온도 관리가 와인 품질에 미치는 영향에서 가장 중요한 요소는?",
                options: [
                    "효모 대사 속도와 부산물 생성 패턴의 제어",
                    "휘발성 아로마 화합물의 보존과 추출 균형",
                    "색소 추출 효율성과 타닌 용해도의 최적화",
                    "알코올 생성 속도와 당 소비율의 조절"
                ],
                correct: 1,
                explanation: "발효 온도는 휘발성 아로마 화합물의 생성과 보존에 직접적 영향을 미치며, 적절한 온도 관리를 통해 원하는 아로마 프로파일을 달성할 수 있습니다."
            },
            {
                category: "양조학",
                question: "Whole Cluster Fermentation(전송이 발효)의 장점과 주의해야 할 리스크는?",
                options: [
                    "스파이시한 아로마 증가, 그러나 그린 타닌 위험성 존재",
                    "색소 추출 향상, 그러나 과도한 탄닌 추출 가능성",
                    "발효 속도 조절, 그러나 불완전 발효 위험성",
                    "산도 보존 효과, 그러나 pH 상승으로 인한 불안정성"
                ],
                correct: 0,
                explanation: "전송이 발효는 줄기에서 나오는 스파이시한 아로마를 얻을 수 있지만, 줄기가 완전히 성숙하지 않으면 그린 타닌이 와인에 추출될 위험이 있습니다."
            },
            {
                category: "양조학",
                question: "와인의 단백질 안정화 처리에서 벤토나이트 사용의 메커니즘과 부작용은?",
                options: [
                    "양전하 단백질 흡착 제거, 색소와 아로마 손실 부작용",
                    "음전하 단백질 응집 유도, 과도한 청징으로 인한 여과 문제",
                    "효소적 단백질 분해 촉진, 아미노산 부산물 생성 위험",
                    "단백질 변성을 통한 침전 유도, pH 변화로 인한 불안정"
                ],
                correct: 0,
                explanation: "벤토나이트는 음전하를 띤 점토 광물로 양전하를 띤 단백질을 흡착하여 제거하지만, 동시에 일부 색소와 아로마 화합물도 함께 제거할 수 있어 신중한 사용이 필요합니다."
            },
            {
                category: "양조학",
                question: "크로스플로우 필터레이션(Cross-flow Filtration)의 원리와 기존 필터와의 차이점은?",
                options: [
                    "접선 방향 유동으로 막 표면 오염 최소화, 높은 처리량 가능",
                    "역삼투압 원리 적용으로 미세 불순물 완전 제거 가능",
                    "압력차를 이용한 선택적 분리, 에너지 효율성 극대화",
                    "중력 여과와 압력 여과의 결합, 품질 손실 최소화"
                ],
                correct: 0,
                explanation: "크로스플로우 필터레이션은 와인이 막 표면에 평행하게 흐르면서 여과되어 막 표면의 케이크층 형성을 방지하고, 지속적으로 높은 처리량을 유지할 수 있습니다."
            },

            // 지역별 전문지식 (80문제)
            {
                category: "지역별 전문지식",
                question: "샴페인 지역의 Montagne de Reims와 Vallée de la Marne의 테루아 차이가 와인 스타일에 미치는 영향은?",
                options: [
                    "Montagne는 구조감, Vallée는 과실미와 부드러움 강조",
                    "두 지역 모두 동일한 스타일이나 숙성 잠재력이 다름",
                    "Montagne는 미네랄, Vallée는 플로랄 특성이 강함",
                    "기후 조건은 유사하나 토양 pH 차이로 산도가 다름"
                ],
                correct: 0,
                explanation: "Montagne de Reims는 석회질 토양과 언덕 사면의 특성으로 구조적이고 힘 있는 와인을, Vallée de la Marne는 점토와 사질토양으로 부드럽고 과실미가 풍부한 와인을 생산합니다."
            },
            {
                category: "지역별 전문지식",
                question: "부르고뉴의 Premier Cru와 Village 등급 간 테루아의 실질적 차이는?",
                options: [
                    "경사도와 일조 조건의 차이로 인한 숙성도 격차",
                    "토양 깊이와 배수 능력의 차이로 인한 스트레스 정도",
                    "미기후와 토양 구성의 최적 조건 집중도",
                    "포도나무 수령과 재식 밀도의 전통적 차이"
                ],
                correct: 2,
                explanation: "Premier Cru는 Village 등급 대비 경사, 일조, 배수, 토양 구성 등 모든 테루아 조건이 최적으로 집중된 구역으로, 이러한 조건의 집중도가 품질 차이를 만들어냅니다."
            },
            {
                category: "지역별 전문지식",
                question: "바롤로와 바르바레스코의 네비올로가 보이는 스타일 차이의 주된 원인은?",
                options: [
                    "바롤로는 더 따뜻한 기후로 알코올 도수가 높음",
                    "바르바레스코의 석회질 토양이 더 우아한 스타일 형성",
                    "바롤로의 더 긴 숙성 규정이 구조적 차이 생성",
                    "두 지역의 고도와 사면 방향 차이로 인한 숙성도 격차"
                ],
                correct: 3,
                explanation: "바르바레스코는 일반적으로 바롤로보다 낮은 고도와 남향 사면의 유리한 조건으로 더 일찍 익어 상대적으로 부드럽고 접근하기 쉬운 스타일을 보입니다."
            },
            {
                category: "지역별 전문지식",
                question: "독일 라인가우의 Riesling과 모젤의 Riesling 스타일 차이의 지질학적 배경은?",
                options: [
                    "라인가우의 점판암 vs 모젤의 슬레이트 토양 차이",
                    "두 지역의 강물 반사열 효과 정도의 차이",
                    "포도원 경사도와 기계화 가능성의 차이",
                    "전통적인 양조법과 현대적 기법 적용의 차이"
                ],
                correct: 0,
                explanation: "라인가우의 점판암 토양은 더 풍부하고 구조적인 와인을, 모젤의 슬레이트(청판암) 토양은 미네랄리티가 뛰어나고 우아한 와인을 생산합니다."
            },
            {
                category: "지역별 전문지식",
                question: "론 밸리 북부와 남부의 기후와 토양 차이가 시라/시라즈에 미치는 영향은?",
                options: [
                    "북부는 대륙성, 남부는 지중해성 기후로 완전히 다른 스타일",
                    "토양보다는 바람(미스트랄)의 영향이 더 결정적",
                    "북부의 화강암 vs 남부의 사질토양이 미네랄 차이 생성",
                    "남부의 GSM 블렌딩 전통이 시라 스타일에 영향"
                ],
                correct: 0,
                explanation: "론 북부는 대륙성 기후와 화강암 토양으로 집중되고 미네랄한 시라를, 남부는 지중해성 기후와 다양한 토양으로 더 풍부하고 스파이시한 시라를 생산합니다."
            },
            {
                category: "지역별 전문지식",
                question: "토스카나 Chianti Classico의 Sangiovese가 Brunello di Montalcino와 다른 특성을 보이는 이유는?",
                options: [
                    "키안티의 블렌딩 허용 vs 브루넬로의 상지오베제 100%",
                    "두 지역의 고도 차이로 인한 기후 조건 격차",
                    "몬탈치노의 갈레스트로 토양 vs 키안티의 알베레제 토양",
                    "상지오베제 그로소와 상지오베제 피콜로의 클론 차이"
                ],
                correct: 1,
                explanation: "몬탈치노는 키안티 클라시코보다 높은 고도(500m vs 300m)와 더 따뜻한 기후로 인해 상지오베제가 더 완전히 익어 집중되고 힘있는 와인을 생산합니다."
            },
            {
                category: "지역별 전문지식",
                question: "리오하의 DOCa 분류에서 Crianza, Reserva, Gran Reserva의 법적 숙성 규정은?",
                options: [
                    "Crianza 2년(오크 1년), Reserva 3년(오크 1년), Gran Reserva 5년(오크 2년)",
                    "Crianza 1년(오크 6개월), Reserva 2년(오크 1년), Gran Reserva 4년(오크 18개월)",
                    "모두 동일한 오크 숙성 기간, 총 숙성 기간만 차이",
                    "Crianza 18개월(오크 6개월), Reserva 3년(오크 1년), Gran Reserva 5년(오크 2년)"
                ],
                correct: 0,
                explanation: "리오하 DOCa의 적색 와인 숙성 규정은 Crianza 2년(오크 1년), Reserva 3년(오크 1년), Gran Reserva 5년(오크 2년)으로 엄격히 규정되어 있습니다."
            },
            {
                category: "지역별 전문지식",
                question: "포르투갈 도우로 밸리의 포트 와인 등급 체계에서 'Quinta'의 의미와 품질 지위는?",
                options: [
                    "단일 포도원 와인으로 최상급 빈티지 포트의 지위",
                    "특정 생산자의 독점 브랜드명으로 품질과 무관",
                    "혼합 와인 대비 순수성을 강조한 마케팅 용어",
                    "전통적인 트레가 시스템의 현대적 계승 개념"
                ],
                correct: 0,
                explanation: "퀸타(Quinta)는 단일 포도원에서 생산된 포트 와인으로, 최상급 빈티지 포트에만 사용되며 해당 포도원의 독특한 테루아를 표현하는 최고 등급입니다."
            },
            {
                category: "지역별 전문지식",
                question: "헝가리 토카이 지역의 Aszú 와인 등급 체계에서 'Puttonyos'의 정확한 의미는?",
                options: [
                    "수확 바구니 단위로 표시된 귀부 포도 농축 정도",
                    "발효 기간을 나타내는 전통적인 시간 단위",
                    "토카이 지역의 포도원 구획을 나타내는 지리적 표시",
                    "당도 측정 단위로 현대적 브릭스와 동일한 개념"
                ],
                correct: 0,
                explanation: "푸토뇨쉬(Puttonyos)는 전통적으로 귀부 포도를 담는 바구니 단위로, 3-6 puttonyos는 일반 와인에 귀부 포도를 얼마나 첨가했는지 나타내는 농축도 지표입니다."
            },
            {
                category: "지역별 전문지식",
                question: "남아프리카 스텔렌보쉬의 WO(Wine of Origin) 시스템에서 Ward와 District의 차이는?",
                options: [
                    "Ward는 더 세분화된 지역으로 District 내부의 하위 구분",
                    "District는 행정구역, Ward는 테루아 기반 자연 구분",
                    "두 용어는 동일한 의미로 상호 교체 사용 가능",
                    "Ward는 신규 지정 구역, District는 전통적 구역"
                ],
                correct: 0,
                explanation: "남아공 WO 시스템에서 Ward는 District 내부의 더 작고 세분화된 지역 단위로, 보다 구체적인 테루아 특성을 반영하는 하위 지리적 표시입니다."
            },

            // 테이스팅 & 평가 (40문제)
            {
                category: "테이스팅 & 평가",
                question: "와인에서 'Brett' 결함(Brettanomyces)의 화학적 원인과 식별 방법은?",
                options: [
                    "4-ethylphenol과 4-ethylguaiacol 화합물로 인한 동물적/약품 냄새",
                    "Acetobacter 감염으로 인한 식초산 냄새와 신맛 증가",
                    "과도한 SO2 사용으로 인한 성냥불과 황 냄새",
                    "Lactobacillus 오염으로 인한 사워크라우트와 버터산 냄새"
                ],
                correct: 0,
                explanation: "브렛(Brettanomyces) 효모는 4-ethylphenol과 4-ethylguaiacol을 생성하여 동물 냄새, 반창고, 약품 냄새 등을 만들어내며, 이는 와인의 품질을 심각하게 손상시킵니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "와인의 'Mousy' 결함 식별과 그 발생 원인은?",
                options: [
                    "Lactobacillus 감염으로 인한 쥐 냄새, 입 안에서만 감지",
                    "코르크 오염으로 인한 곰팡이 냄새, 코에서 직접 감지",
                    "과숙한 포도로 인한 동물적 냄새, 지속적 감지",
                    "높은 pH로 인한 암모니아 냄새, 후각에서만 감지"
                ],
                correct: 0,
                explanation: "Mousy 결함은 Lactobacillus나 Brettanomyces 감염으로 발생하며, 특이하게 와인을 삼킨 후 입 안에서만 감지되는 불쾌한 쥐 냄새가 특징입니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "블라인드 테이스팅에서 Old World와 New World Chardonnay를 구분하는 핵심 지표는?",
                options: [
                    "산도 구조와 미네랄리티 vs 과실 농축도와 오크 사용",
                    "알코올 도수와 바디감의 차이만으로 구분 가능",
                    "발효 온도 차이로 인한 아로마 프로파일의 격차",
                    "수확 시기 차이로 인한 당산 균형의 스타일 차이"
                ],
                correct: 0,
                explanation: "Old World 샤르도네는 일반적으로 높은 산도와 미네랄리티를 중시하는 반면, New World는 과실의 농축도와 오크 사용을 통한 바닐라, 버터 풍미를 강조하는 경향이 있습니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "와인의 'Green' 특성과 'Herbaceous' 특성의 구분 기준은?",
                options: [
                    "Green은 미숙함, Herbaceous는 품종 특성으로 구분",
                    "두 용어는 동일한 의미로 상호 교체 사용 가능",
                    "Green은 결함, Herbaceous는 테루아 표현으로 평가",
                    "농도 차이로만 구분되며 본질적으로는 동일함"
                ],
                correct: 0,
                explanation: "Green 특성은 포도의 미숙으로 인한 부정적 요소인 반면, Herbaceous는 Cabernet Sauvignon이나 Sauvignon Blanc 등 특정 품종의 고유한 허브적 특성으로 긍정적으로 평가됩니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "와인의 텍스처(질감) 평가에서 '입안 무게감'을 결정하는 주요 요소는?",
                options: [
                    "알코올, 당분, 글리세롤, 추출물의 복합적 작용",
                    "타닌과 산도의 상호작용으로만 결정됨",
                    "와인의 점도와 밀도의 물리적 특성",
                    "발효와 숙성 과정에서 형성된 에스테르 화합물"
                ],
                correct: 0,
                explanation: "와인의 무게감(Body)은 알코올, 잔당, 글리세롤, 총 추출물 등이 복합적으로 작용하여 만들어지며, 이는 입안에서 느껴지는 와인의 농도와 밀도감을 결정합니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "숙성된 적색 와인에서 나타나는 '가죽(leather)' 아로마의 화학적 기원은?",
                options: [
                    "타닌의 중합과 안토시아닌의 변화로 형성된 복합 화합물",
                    "Brettanomyces 효모의 활동으로 생성된 페놀 화합물",
                    "코르크와의 장기 접촉으로 형성된 테르펜 유도체",
                    "단백질 분해로 인한 아미노산 유도체의 축적"
                ],
                correct: 0,
                explanation: "가죽 아로마는 주로 와인 숙성 과정에서 타닌이 중합되고 안토시아닌이 변화하면서 형성되는 복합적인 화합물로, 잘 숙성된 적색 와인의 긍정적 특성입니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "스파클링 와인의 품질 평가에서 거품(mousse)의 질을 판단하는 기준은?",
                options: [
                    "기포의 크기, 지속성, 상승 패턴의 일관성",
                    "기포의 양과 소리만으로 판단 가능",
                    "색깔 변화와 온도에 따른 반응 정도",
                    "잔에서의 분포 균일성과 소멸 속도"
                ],
                correct: 0,
                explanation: "고품질 스파클링 와인의 거품은 작고 균일한 크기, 지속적인 상승, 일관된 패턴을 보이며, 이는 세심한 2차 발효와 숙성 과정의 결과입니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "디저트 와인의 당도와 산도 균형 평가에서 '클로잉(cloying)'을 피하는 기준은?",
                options: [
                    "잔당 대비 충분한 산도 확보로 청량감 유지",
                    "알코올 도수를 높여 당분 인식 상쇄",
                    "타닌 성분 추가로 구조감 부여",
                    "향신료 계열 아로마로 단맛 마스킹"
                ],
                correct: 0,
                explanation: "디저트 와인에서 끈적한 느낌(cloying)을 피하려면 높은 잔당에 상응하는 충분한 산도가 필요하며, 이 균형이 와인의 우아함과 마시기 쉬운 정도를 결정합니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "와인의 '미네랄리티' 표현의 과학적 근거와 테이스팅에서의 식별법은?",
                options: [
                    "토양 미네랄의 직접 전달보다는 산도와 추출물의 특정 조합",
                    "칼슘과 마그네슘 등 미네랄 성분의 직접적 맛",
                    "특정 토양 타입에서만 나타나는 고유한 화합물",
                    "포도나무 뿌리가 흡수한 무기질의 농축된 표현"
                ],
                correct: 0,
                explanation: "와인의 미네랄리티는 토양 미네랄의 직접 전달보다는 특정 산도 구조와 추출물의 조합으로 인한 감각적 인상으로, 청량하고 깔끔한 뒷맛과 입안의 침 분비 촉진으로 식별됩니다."
            },
            {
                category: "테이스팅 & 평가",
                question: "와인 컨디션 평가에서 'Corked' 와인과 'Oxidized' 와인의 구별법은?",
                options: [
                    "Corked는 TCA로 인한 곰팡이 냄새, Oxidized는 아세트알데하이드로 인한 셰리 냄새",
                    "두 결함 모두 동일한 화합물로 인해 발생하나 농도가 다름",
                    "Corked는 시간이 지나면 사라지나 Oxidized는 지속됨",
                    "온도에 따른 반응이 다르게 나타나는 것으로 구별"
                ],
                correct: 0,
                explanation: "코르키한 와인은 TCA(2,4,6-trichloroanisole)로 인한 젖은 골판지, 곰팡이 냄새가 특징이고, 산화된 와인은 아세트알데하이드로 인한 셰리, 견과류, 사과 냄새가 특징입니다."
            },

            // 와인 비즈니스 (40문제)
            {
                category: "와인 비즈니스",
                question: "와인 저장에서 이상적인 온도와 습도 조건 및 그 과학적 근거는?",
                options: [
                    "12-15°C, 습도 70-75%로 코르크 보존과 화학 반응 안정화",
                    "10-12°C, 습도 60-65%로 미생물 억제와 증발 최소화",
                    "15-18°C, 습도 75-80%로 자연 숙성 촉진과 공기 순환",
                    "8-10°C, 습도 80-85%로 완전한 보존과 변화 억제"
                ],
                correct: 0,
                explanation: "와인의 이상적 저장 조건은 온도 12-15°C, 습도 70-75%로, 이는 코르크의 적절한 수분 유지와 와인 내 화학 반응의 안정적 진행을 보장합니다."
            },
            {
                category: "와인 비즈니스",
                question: "레스토랑에서 와인 서빙 온도 관리의 실무적 가이드라인은?",
                options: [
                    "적색 17-18°C, 백색 8-12°C, 스파클링 6-8°C로 스타일별 차등 적용",
                    "모든 와인을 셀러 온도인 15°C로 일관되게 서빙",
                    "고객 취향에 따라 온도 조절하되 안전 범위 내 유지",
                    "계절과 날씨를 고려해 여름철에는 모든 와인을 더 차갑게"
                ],
                correct: 0,
                explanation: "적색 와인은 17-18°C에서 아로마와 타닌이 최적으로 표현되고, 백색 와인은 8-12°C에서 산도와 신선함이 돋보이며, 스파클링은 6-8°C에서 탄산가스 용해도가 이상적입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인리스트 구성에서 가격 설정의 마케팅 심리학적 원칙은?",
                options: [
                    "앵커 효과를 위한 고가 와인 배치와 적정선 유도",
                    "모든 가격대를 균등하게 분배하여 선택의 다양성 확보",
                    "원가의 정확한 3배수로 일관된 마진율 적용",
                    "경쟁업체 가격 대비 10% 할인된 수준으로 설정"
                ],
                correct: 0,
                explanation: "와인리스트에서 고가 와인은 앵커 효과를 만들어 중간 가격대 와인을 합리적으로 보이게 하며, 고객을 적정 가격선으로 유도하는 심리학적 효과가 있습니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인 투자에서 투자가치 평가의 핵심 요소들은?",
                options: [
                    "생산자 명성, 빈티지 평가, 희소성, 저장 상태의 종합 고려",
                    "구매 가격과 현재 시세의 단순 차익만 계산",
                    "와인 평론가 점수와 상장 경력만으로 판단",
                    "지역별 브랜드 인지도와 마케팅 투자 규모"
                ],
                correct: 0,
                explanation: "와인 투자가치는 생산자의 시장 명성, 특정 빈티지의 품질 평가, 생산량에 따른 희소성, 프로베넌스를 포함한 저장 상태 등을 종합적으로 평가해야 합니다."
            },
            {
                category: "와인 비즈니스",
                question: "음식과 와인 페어링에서 '대비(Contrast)' 원칙의 성공적 적용 사례는?",
                options: [
                    "달콤한 디저트와 산도 높은 Riesling의 조합",
                    "구운 고기와 탄닌 강한 적색 와인의 조합",
                    "해산물과 미네랄한 백색 와인의 조합",
                    "치즈와 같은 지역 와인의 조합"
                ],
                correct: 0,
                explanation: "대비 페어링은 음식과 와인이 상반된 특성을 가질 때 서로를 부각시키는 효과로, 달콤한 디저트와 산도 높은 와인의 조합이 대표적 성공 사례입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인 경매에서 프로베넌스(Provenance) 검증의 중요성과 방법은?",
                options: [
                    "저장 이력과 소유권 연속성 확인으로 투자가치 보장",
                    "라벨 상태와 코르크 컨디션만 확인하면 충분",
                    "유명 경매장에서 판매된 이력만으로 신뢰성 확보",
                    "고가 와인에서만 필요한 선택적 검증 절차"
                ],
                correct: 0,
                explanation: "프로베넌스는 와인의 저장 환경, 소유권 이력, 운송 조건 등의 연속성을 검증하여 와인의 품질과 투자가치를 보장하는 핵심 요소입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인 소믈리에의 블라인드 테이스팅 실무에서 체계적 접근법은?",
                options: [
                    "외관-아로마-맛-질감-피니쉬 순서의 단계별 분석 후 종합 판단",
                    "첫인상에 의존한 직관적 판단이 가장 정확",
                    "가격대 추정을 통한 품질 수준 사전 설정",
                    "음식 매칭 가능성을 우선 고려한 실용적 접근"
                ],
                correct: 0,
                explanation: "전문적인 블라인드 테이스팅은 외관, 아로마, 맛, 질감, 피니쉬를 체계적으로 분석한 후 이를 종합하여 품종, 지역, 빈티지를 추론하는 과정입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인바 운영에서 글라스 와인 프로그램의 성공 요소는?",
                options: [
                    "적정 회전율과 보존 시스템을 통한 품질 유지",
                    "최대한 많은 종류의 와인을 소량씩 보관",
                    "고가 와인 중심으로 구성하여 마진율 극대화",
                    "트렌드에 맞춰 메뉴를 자주 변경하여 신선함 유지"
                ],
                correct: 0,
                explanation: "글라스 와인 프로그램의 성공은 적절한 회전율로 신선도를 유지하고, Coravin 등 보존 시스템을 활용하여 개봉 후에도 품질을 보장하는 것입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인 컬렉션 관리에서 셀러 인벤토리 시스템의 필수 요소는?",
                options: [
                    "위치 추적, 음용 적기 알림, 가치 변동 모니터링",
                    "단순한 수량 계산과 구매 가격 기록만으로 충분",
                    "와인 평점과 리뷰 데이터베이스 연동",
                    "소셜미디어 공유 기능과 커뮤니티 연결"
                ],
                correct: 0,
                explanation: "전문적인 와인 셀러 관리는 각 와인의 정확한 위치, 최적 음용 시기 알림, 시장가치 변동 추적 등 체계적인 인벤토리 관리가 필수입니다."
            },
            {
                category: "와인 비즈니스",
                question: "와인 교육 프로그램에서 초급자를 위한 효과적인 티칭 메소드는?",
                options: [
                    "대표 품종별 특성 대비와 체험을 통한 점진적 학습",
                    "복잡한 지역별 특성과 법규부터 상세히 설명",
                    "고가 와인 위주의 시음으로 품질 기준 설정",
                    "이론 중심의 체계적 지식 전달 후 실습"
                ],
                correct: 0,
                explanation: "와인 교육 초급자에게는 Chardonnay vs Sauvignon Blanc, Pinot Noir vs Cabernet Sauvignon 등 대표 품종 간 명확한 차이를 체험하게 하여 기본 틀을 만드는 것이 효과적입니다."
            }
        ];

        // 문제 섞기 함수
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // 게임 시작 함수
        function startGame() {
            console.log('게임 시작');
            
            // 300개 문제 중 10개 랜덤 선택
            const shuffledQuestions = shuffleArray(wineQuestions);
            gameState.selectedQuestions = shuffledQuestions.slice(0, 10);
            gameState.currentQuestion = 0;
            gameState.score = 0;
            gameState.correctAnswers = 0;
            gameState.isGameStarted = true;
            gameState.answered = false;

            // 화면 전환
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            document.getElementById('resultScreen').style.display = 'none';

            // 첫 번째 문제 표시
            showQuestion();
        }

        // 문제 표시 함수
        function showQuestion() {
            const question = gameState.selectedQuestions[gameState.currentQuestion];
            
            document.getElementById('currentQ').textContent = gameState.currentQuestion + 1;
            document.getElementById('currentScore').textContent = gameState.score;
            document.getElementById('progressBar').style.width = ((gameState.currentQuestion + 1) * 10) + '%';
            
            document.getElementById('questionCategory').textContent = question.category;
            document.getElementById('questionText').textContent = question.question;
            
            const answerButtons = document.querySelectorAll('.answer-btn');
            const answerTexts = document.querySelectorAll('.answer-text');
            
            question.options.forEach((option, index) => {
                answerTexts[index].textContent = option;
                answerButtons[index].className = 'answer-btn w-full text-left p-4 bg-gray-50 hover:bg-purple-50 border border-gray-200 hover:border-purple-300 rounded-lg transition-all duration-200';
                answerButtons[index].disabled = false;
            });

            // 피드백 섹션 숨기기
            document.getElementById('feedbackSection').style.display = 'none';
            gameState.answered = false;
        }

        // 답 선택 함수
        function selectAnswer(selectedIndex) {
            if (gameState.answered) return;

            const question = gameState.selectedQuestions[gameState.currentQuestion];
            const answerButtons = document.querySelectorAll('.answer-btn');
            
            gameState.answered = true;

            // 모든 버튼 비활성화
            answerButtons.forEach(btn => btn.disabled = true);

            // 정답 표시
            answerButtons.forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.remove('bg-gray-50', 'hover:bg-purple-50');
                    btn.classList.add('bg-green-500', 'text-white', 'pulse-correct');
                } else if (index === selectedIndex) {
                    btn.classList.remove('bg-gray-50', 'hover:bg-purple-50');
                    btn.classList.add('bg-red-500', 'text-white', 'pulse-incorrect');
                }
            });

            // 점수 계산
            const isCorrect = selectedIndex === question.correct;
            if (isCorrect) {
                gameState.correctAnswers++;
                gameState.score += 10;
            }

            // 피드백 표시
            showFeedback(isCorrect, question);
        }

        // 피드백 표시 함수
        function showFeedback(isCorrect, question) {
            const feedbackSection = document.getElementById('feedbackSection');
            const feedbackIcon = document.getElementById('feedbackIcon');
            const feedbackText = document.getElementById('feedbackText');
            const explanationText = document.getElementById('explanationText');
            const nextBtn = document.getElementById('nextBtn');

            if (isCorrect) {
                feedbackIcon.innerHTML = '🎉';
                feedbackText.innerHTML = '<span class="text-green-600">정답입니다!</span>';
            } else {
                feedbackIcon.innerHTML = '❌';
                feedbackText.innerHTML = '<span class="text-red-600">오답입니다</span>';
            }

            explanationText.textContent = question.explanation;

            // 버튼 텍스트 설정
            if (gameState.currentQuestion === 9) {
                nextBtn.innerHTML = '결과 보기 <i class="fas fa-trophy ml-2"></i>';
            } else {
                nextBtn.innerHTML = '다음 문제 <i class="fas fa-arrow-right ml-2"></i>';
            }

            feedbackSection.style.display = 'block';
        }

        // 다음 문제 함수
        function nextQuestion() {
            if (gameState.currentQuestion < 9) {
                gameState.currentQuestion++;
                showQuestion();
            } else {
                showResult();
            }
        }

        // 결과 표시 함수
        function showResult() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';

            const finalScore = document.getElementById('finalScore');
            const resultMessage = document.getElementById('resultMessage');
            const resultIcon = document.getElementById('resultIcon');
            const correctCount = document.getElementById('correctCount');
            const incorrectCount = document.getElementById('incorrectCount');

            finalScore.textContent = gameState.score + '점';
            correctCount.textContent = gameState.correctAnswers;
            incorrectCount.textContent = 10 - gameState.correctAnswers;

            // 점수에 따른 메시지와 아이콘
            if (gameState.score >= 80) {
                resultIcon.innerHTML = '🏆';
                resultMessage.textContent = 'WSET3 수준의 전문가입니다! 탁월한 와인 지식을 보여주셨습니다.';
            } else if (gameState.score >= 60) {
                resultIcon.innerHTML = '🥇';
                resultMessage.textContent = '우수한 성과입니다! 와인에 대한 깊은 이해를 보여주셨습니다.';
            } else if (gameState.score >= 40) {
                resultIcon.innerHTML = '🥈';
                resultMessage.textContent = '좋은 성과입니다! 더 많은 학습으로 전문가가 되어보세요.';
            } else {
                resultIcon.innerHTML = '📚';
                resultMessage.textContent = '와인 학습을 시작하는 단계입니다. 꾸준한 공부로 실력을 키워보세요!';
            }
        }

        // 게임 재시작 함수
        function restartGame() {
            // 초기 화면으로 돌아가기
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('gameScreen').style.display = 'none';
            
            // 게임 상태 초기화
            gameState.currentQuestion = 0;
            gameState.score = 0;
            gameState.correctAnswers = 0;
            gameState.isGameStarted = false;
            gameState.answered = false;
            gameState.selectedQuestions = [];
        }

        // DOM 로드 완료 후 이벤트 리스너 설정
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 로드 완료, 이벤트 리스너 설정 중...');
            
            // 시작 버튼
            const startBtn = document.getElementById('startBtn');
            if (startBtn) {
                startBtn.addEventListener('click', startGame);
                console.log('시작 버튼 이벤트 리스너 연결됨');
            }

            // 다음 문제 버튼
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.addEventListener('click', nextQuestion);
                console.log('다음 문제 버튼 이벤트 리스너 연결됨');
            }

            // 재시작 버튼
            const restartBtn = document.getElementById('restartBtn');
            if (restartBtn) {
                restartBtn.addEventListener('click', restartGame);
                console.log('재시작 버튼 이벤트 리스너 연결됨');
            }

            console.log('모든 이벤트 리스너 설정 완료');
        });

        // 전역 함수로 답 선택과 다음 문제 함수 노출
        window.selectAnswer = selectAnswer;
        window.nextQuestion = nextQuestion;

        console.log('와인 퀴즈 게임 초기화 완료');
    </script>
</body>
</html>
